# design

- [流程图、类图](https://www.processon.com/view/link/5c7fb7d0e4b02b2ce48e9975)


## 实现与方案不同点

1. 原方案针对 AUTO_INCREMENT 主键，可以直接根据 id 值进行分组，保证整体均匀抽样。
   - 实现直接使用根据主键由小到大，依次迭代获取记录集，与 VARCHAR 主键实现一样。
   - 主要是考虑原方案实现复杂，且没有必要。经过实测，生产库性能高，迭代速度快，1秒可迭代 > 5万条记录。

2. PGSQL 迭代比较也实现：PGSQL 迭代比较方案与 MySQL 完全相同，不同的只是获取 PGSQL 表字段、主键信息方式不一样。